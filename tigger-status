#!/bin/dash



. tigger-utilities
. tigger-file_state
check_repo_exists



trap "rm  -f $list" EXIT INT




  #################
 #    Defines    #
#################


COMMIT_DIR="$REPO/commit/$("find_where_head_points")"

#File error for given status
UNTRACKED_1=$PWD_ONLY
UNTRACKED_2=$DELTA_REP_PWD
UNTRACKED_3=$REP_AND_PWD
SAME_AS_REPO=$ALL_SAME
FILE_DELETED=$REP_AND_IND
DELETED=$REP_ONLY
ADDED_TO_INDEX=$IND_AND_PWD
ADDED_TO_INDEX_FILE_DELETED=$INDEX_ONLY
ADDED_TO_INDEX_FILE_CHANGED=$DELTA_IND_PWD
DIFF_CHANGES_STAGED_1=$ALL_DIFFERENT
DIFF_CHANGES_STAGED_2=$DELTA_REP_IND_DELTA_IND_PWD
CHANGES_STAGED=$DELTA_REP_IND_DELTA_REP_PWD
CHANGES_NOT_STAGED=$DELTA_IND_PWD_DELTA_REP_PWD
DELETED_STAGED=$DELTA_REP_IND



  #################
 #     Main      #
#################



for file in $(basename --multiple "$COMMIT_DIR"/* "$INDEX_DIR"/* "$PWD"/* |sort|uniq|sed '/*/d' |xargs)
do
  
  status=$(find_files_state "$file" 'HEAD')

  
  [ "$status" = "$UNTRACKED_1" ]         		     && status_msg="untracked" 
  [ "$status" = "$UNTRACKED_2" ]                 && status_msg="untracked"      
  [ "$status" = "$UNTRACKED_3" ]                 && status_msg="untracked"                                       
  [ "$status" = "$SAME_AS_REPO" ]       		     && status_msg="same as repo"                                      
  [ "$status" = "$FILE_DELETED" ]       		     && status_msg="file deleted"                                      
  [ "$status" = "$DELETED" ]            	   	   && status_msg="deleted"                                           
  [ "$status" = "$ADDED_TO_INDEX" ]       		   && status_msg="added to index" 
  [ "$status" = "$ADDED_TO_INDEX_FILE_DELETED" ] && status_msg="added to index, file deleted"
  [ "$status" = "$ADDED_TO_INDEX_FILE_CHANGED" ] && status_msg="added to index, file changed"                                
  [ "$status" = "$DIFF_CHANGES_STAGED_1" ]       && status_msg="file changed, different changes staged for commit"
  [ "$status" = "$DIFF_CHANGES_STAGED_2" ]       && status_msg="file changed, different changes staged for commit" 
  [ "$status" = "$CHANGES_STAGED" ]     	  	   && status_msg="file changed, changes staged for commit"        
  [ "$status" = "$CHANGES_NOT_STAGED" ] 		     && status_msg="file changed, changes not staged for commit"    
  [ "$status" = "$DELETED_STAGED" ]              && status_msg="file deleted, different changes staged for commit" 

  echo "$file - $status_msg"

done

exit 0




